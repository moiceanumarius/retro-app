<!-- Action Description -->
<div class="action-detail-group">
    <label class="action-detail-label">Description</label>
    <div class="action-description-detail">
        <div class="action-description-view" id="modal-view-{{ action.id }}" onclick="editModalActionDescription({{ action.id }})">
            {{ action.description }}
        </div>
        <div class="action-description-edit" id="modal-edit-{{ action.id }}" style="display: none;">
            <textarea class="action-edit-textarea" rows="4" id="modal-text-{{ action.id }}">{{ action.description }}</textarea>
            <div class="action-edit-actions">
                <button class="btn btn-sm btn-success save-action-btn" onclick="saveModalActionDescription({{ action.id }})">
                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                    </svg>
                    Save Changes
                </button>
                <button class="btn btn-sm btn-secondary cancel-action-btn" onclick="cancelModalActionDescription({{ action.id }})">
                    <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Assignee Information -->
<div class="action-detail-group">
    <label class="action-detail-label">Assigned To</label>
    {% if action.assignedTo %}
        <div class="action-assignee-detail">
            <div class="action-assignee-avatar">
                {{ action.assignedTo.email|slice(0,1)|upper }}
            </div>
            <div class="action-assignee-info">
                <div class="action-assignee-name">{{ action.assignedTo.email }}</div>
                <div class="action-assignee-role">
                    {% if action.retrospective.team.owner == action.assignedTo %}
                        Team Owner
                    {% else %}
                        Team Member
                    {% endif %}
                </div>
            </div>
        </div>
    {% else %}
        <div style="color: #9ca3af; font-style: italic; padding: 1rem; background: #f9fafb; border-radius: 8px;">
            No one assigned to this action
        </div>
    {% endif %}
</div>

<!-- Action Metadata -->
<div class="action-metadata">
    <div class="action-metadata-item">
        <div class="label">Status</div>
        <div class="value">
            <div class="status-badge-view" id="modal-status-view-{{ action.id }}" onclick="editModalActionStatus({{ action.id }})">
                <span class="status-badge {{ action.status }}">
                    {{ action.status|replace({'-': ' '})|title }}
                </span>
                <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20" style="margin-left: 4px;">
                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
            </div>
            <div class="status-edit-form" id="modal-status-edit-{{ action.id }}" style="display: none;">
                <select class="status-select" id="modal-status-select-{{ action.id }}" onchange="saveModalActionStatus({{ action.id }})">
                    <option value="pending" {{ action.status == 'pending' ? 'selected' : '' }}>Pending</option>
                    <option value="in-progress" {{ action.status == 'in-progress' ? 'selected' : '' }}>In Progress</option>
                    <option value="completed" {{ action.status == 'completed' ? 'selected' : '' }}>Completed</option>
                    <option value="cancelled" {{ action.status == 'cancelled' ? 'selected' : '' }}>Cancelled</option>
                </select>
                <button class="btn btn-sm btn-secondary cancel-status-btn" onclick="cancelModalActionStatus({{ action.id }})">
                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <div class="action-metadata-item">
        <div class="label">Due Date</div>
        <div class="value">
            <div class="due-date-view" id="modal-due-date-view-{{ action.id }}" onclick="editModalDueDate({{ action.id }})">
                {% if action.dueDate %}
                    <span>{{ action.dueDate|date('l, F j, Y') }}</span>
                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20" style="margin-left: 4px;">
                        <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                    </svg>
                {% else %}
                    <span style="color: #9ca3af;">No due date set</span>
                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20" style="margin-left: 4px;">
                        <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                    </svg>
                {% endif %}
            </div>
            <div class="due-date-edit-form" id="modal-due-date-edit-{{ action.id }}" style="display: none;">
                <input type="date" class="due-date-input" id="modal-due-date-input-{{ action.id }}" 
                       value="{{ action.dueDate ? action.dueDate|date('Y-m-d') : '' }}"
                       data-original-value="{{ action.dueDate ? action.dueDate|date('Y-m-d') : '' }}">
                <button class="btn btn-sm btn-secondary" onclick="saveModalDueDate({{ action.id }})">
                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"></path>
                    </svg>
                </button>
                <button class="btn btn-sm btn-outline-secondary" onclick="cancelModalDueDate({{ action.id }})">
                    <svg width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <div class="action-metadata-item">
        <div class="label">Created By</div>
        <div class="value">{{ action.createdBy.email }}</div>
    </div>

    <div class="action-metadata-item">
        <div class="label">Created At</div>
        <div class="value">{{ action.createdAt|date('M d, Y H:i') }}</div>
    </div>

    {% if action.completedAt %}
    <div class="action-metadata-item">
        <div class="label">Completed At</div>
        <div class="value">{{ action.completedAt|date('M d, Y H:i') }}</div>
    </div>
    {% endif %}
</div>

<style>
.status-badge {
    padding: 0.375rem 0.75rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    display: inline-block;
}

.status-badge.pending {
    background: #64748b;
    color: white;
}

.status-badge.open {
    background: #ff6b6b;
    color: white;
}

.status-badge.in-progress {
    background: #ffd93d;
    color: #744210;
}

.status-badge.completed {
    background: #6bcf7f;
    color: white;
}

.status-badge.cancelled {
    background: #94a3b8;
    color: white;
}
</style>